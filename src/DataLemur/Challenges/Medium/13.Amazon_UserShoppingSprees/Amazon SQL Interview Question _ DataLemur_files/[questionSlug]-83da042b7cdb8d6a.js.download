(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9755],{36315:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/questions/[questionSlug]",function(){return s(42514)}])},42514:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return x},default:function(){return I},usersPageLimitAndFields:function(){return w}});var a=s(28598),i=s(82684),n=s(34376),o=s(81566),r=s(35585),u=s(44806),l=s(68925),d=s.n(l),c=s(83892),m=s(10406),f=s(86105),g=s(78239),_=s(29262),h=s(41191),p=s(17603),y=s(31382);let b={id:(0,s(55402).Z)(),firstName:null,lastName:null,email:"anonymous@gmail.com",avatar:null,userName:null},S={fields:["id","slug","title","og_title","og_image","description","seo_description","solution_explanation","difficulty","proper_query","base_query","company","category","access_groups","python_function_query","python_test_cases","company_info.*"]};var C=s(46851),E=s.n(C),x=!0;let w={limit:20,fields:["id","first_name","last_name","email","user_name","avatar"]};var I=e=>{var t;let{initialQuestionData:s,isMobile:l}=e,[C]=(0,o.a)("(min-width: 890px)",{ssr:!0,fallback:!1}),{user:x,isAuthInitialized:I,isLoading:q}=(0,g.aF)(),{asPath:N}=(0,n.useRouter)(),[Q,k]=(0,i.useState)(c.BX.Watch),[{result:v,loading:T,error:M},O]=(0,i.useState)({result:null,loading:!1,error:null}),[{fetched:G,loading:P,data:D},j]=(0,i.useState)({loading:!1,fetched:!s.isGuarded,data:s}),A=D.id,B=null==x?void 0:x.id,[{fetched:F,data:V},z]=(0,i.useState)({loading:!1,fetched:!1,data:[]}),[{fetched:L,loading:R},U]=(0,i.useState)({loading:!1,fetched:!1}),[Y,K]=(0,i.useState)([]),[X,Z]=(0,i.useState)([]),[$,H]=(0,i.useState)([]),[J,W]=(0,i.useState)(!0),[ee,et]=(0,i.useState)(()=>f.t$.MostVotes),[es,ea]=(0,i.useState)(()=>(0,h.YQ)({questionId:A,isParentIdNull:!0,limit:20,page:0})),ei=(0,i.useMemo)(()=>(0,h.YQ)({questionId:A,userId:B,isParentIdNull:!0,limit:-1}),[A,B]),en=(0,i.useMemo)(()=>(0,h.YQ)({questionId:A,isParentIdNull:!1,limit:-1}),[A]),eo=(0,g.Ey)(es),er=(0,g.Ey)(R),eu=(0,g.Ey)(J),[el,ed]=(0,i.useState)({loading:!1,fetched:!1,data:[]}),[ec,em]=(0,i.useState)([]),[ef,eg]=(0,i.useState)(f.OK.QuestionDescription),e_=(0,y.Wz)(e=>e.resetState),eh=!!(null==x?void 0:null===(t=x.accessGroups)||void 0===t?void 0:t.length),ep=D.title,ey=(0,_.G0)(D.category),eb=ef===f.OK.QuestionDiscussion,eS=(0,i.useMemo)(()=>D.isGuarded,[D]),eC=(0,i.useCallback)(e=>e.parentId?H(t=>[e,...t]):Z(t=>[e,...t]),[]),eE=(0,i.useCallback)((e,t)=>t?H(t=>(t||[]).filter(t=>t.id!==e)):Z(t=>(t||[]).filter(t=>t.id!==e)),[]),ex=(0,i.useCallback)(e=>{ed(t=>({...t,data:[...t.data,e]}))},[]);(0,i.useEffect)(()=>{W(!0),Z([]),K([]),ea(e=>({...e,sort:ee===f.t$.MostVotes?"-upvotes":ee===f.t$.NewestToOldest?"-created_at":"created_at",page:0}))},[ee]);let ew=(0,i.useCallback)(e=>O(t=>({...t,loading:e})),[]),eI=(0,i.useCallback)(e=>O(t=>({...t,result:e})),[]),eq=(0,i.useCallback)(e=>O(t=>({...t,error:e})),[]),eN=(0,i.useCallback)(async()=>{if(x&&!eS&&!er.current&&eu.current)try{U(e=>({...e,loading:!0}));let e={...eo.current,page:eo.current.page+1,filter:{...eo.current.filter,user_id:{_neq:x.id}}};ea(e);let t=await p.OS.getComments(e);if(0===t.length){U(e=>({...e,loading:!1})),W(!1);return}let s=Array.from(new Set(t.map(e=>e.userId))),a=s.length>0?await p.KD.getUsersByIds(s,w):[];t.forEach(e=>{e.user=a.find(t=>t.id===e.userId)||b}),K(e=>{let s=[...e||[],...t];return(0,_._M)(s,"id")}),U(e=>({...e,loading:!1}))}catch(e){console.error(e),U(e=>({...e,loading:!1}))}},[x,eS,eo,eu,er]);(0,i.useEffect)(()=>{!x||!eh&&eS||R||L||(async()=>{try{U(e=>({...e,loading:!0}));let[e,t]=await Promise.all([p.OS.getReplies(en),p.OS.getComments(ei)]);e.length&&!Y.length&&l&&eN();let s=Array.from(new Set([...e,...t].map(e=>e.userId))),a=s.length>0?await p.KD.getUsersByIds(s,w):[];t.forEach(e=>{e.user=a.find(t=>t.id===e.userId)||b}),e.forEach(e=>{e.user=a.find(t=>t.id===e.userId)||b}),H(e),Z(t),U({fetched:!0,loading:!1})}catch(e){console.log(e),U({fetched:!0,loading:!1})}})()},[x,l,L,R,eh,eS,ee,ei,en,Y.length,eN]),(0,i.useEffect)(()=>{if(!q&&I&&!x){j(e=>({...e,loading:!1,fetched:!0}));return}if(x){if(!x.accessGroups||!D.accessGroups||!(0,_.Jd)(x.accessGroups,D.accessGroups).length){j(e=>({...e,loading:!1,fetched:!0}));return}G||P||(async()=>{try{j(e=>({...e,loading:!0}));let e=await p.aE.getGuardedQuestionBySlug(D.slug,D.accessGroups,S);j(t=>({loading:!1,fetched:!0,data:{...e,companyInfo:t.data.companyInfo}}))}catch(e){j(e=>({...e,loading:!1,fetched:!0}))}})()}},[x,q,I,G,P,D.slug,D.accessGroups]),(0,i.useEffect)(()=>{if(I&&!eS){if(!B){z({loading:!1,fetched:!0,data:[]});return}(async()=>{z(e=>({...e,loading:!0}));try{let e=await p.by.getSubmissions({fields:["id","submitted_at","status","query"],sort:"-submitted_at",filter:{user_id:{_eq:B},question_id:{_eq:A}}});z({loading:!1,fetched:!0,data:e})}catch(e){p.Yd.error(e),z({loading:!1,fetched:!0,data:[]})}})()}},[I,B,A,eS]),(0,i.useEffect)(()=>{eS||(async()=>{try{let e=await p.TE.getHints({fields:["text","order"],sort:"order",filter:{question_id:{_eq:A}}});em(e)}catch(e){p.Yd.error(e),em([])}})()},[A,eS]),(0,i.useEffect)(()=>{(0,_.mV)(N)},[N]),(0,i.useEffect)(()=>()=>{e_()},[e_]);let eQ=()=>(0,a.jsx)(h.wG,{question:D,submitResult:v,submissions:V,tabIndex:ef,setTabIndex:eg,isDiscussionTabActive:eb,areSubmissionsFetched:F,submitTableError:M,isSubmitTableLoading:T,isTextQuestionLoading:Q===c.BX.Submit,hints:ec,currentComments:Y,myComments:X,commentReplies:$,getMoreComments:eN,isLoadingComments:R,commentsFilter:ee,setCommentsFilter:et,hasMoreComments:J,votesState:el,setVotesState:ed,isMobile:l,onCommentAdd:eC,onCommentDelete:eE,onVoteAdd:ex,isQuestionLoading:P}),ek=()=>(0,a.jsx)(h.up,{codeEditorClassName:E().codeEditor,currentOperation:Q,questionId:A,setTabIndex:eg,setSubmissionsState:z,setCurrentOperation:k,setIsSubmittedTableLoading:ew,setSubmittedQueryResult:eI,setSubmittedQueryError:eq,isMobile:l,isPythonQuestion:D.category===f.vu.Python,...D}),ev=()=>(0,a.jsx)(h.U5,{currentOperation:Q,setTabIndex:eg,setCurrentOperation:k,handleCommentAdd:eC,handleVoteAdd:ex,isSubmitBtnDisabled:eS,...D}),eT=()=>ey?ek():ev();return(0,a.jsx)(m.Z,{className:d()(E().layout,{[E().layoutMobileContent]:l}),contentClassName:E().layoutContent,tabTitle:ep,tabDescription:D.seoDescription,...D,ogTitle:D.ogTitle||ep,isShareButtonVisible:!0,isFooterHidden:!0,children:(0,a.jsxs)(r.k,{h:"100%",p:"8px 20px 0 20px",flexDirection:"column",children:[!C&&(0,a.jsx)(h.M_,{text:"Back to questions"}),(0,a.jsx)(r.k,{marginTop:"10px",className:E().questionContainer,children:l||eb?(0,a.jsxs)(a.Fragment,{children:[eQ(),!eb&&eT()]}):(0,a.jsxs)(u.Z,{sizes:[50,50],minSize:[300,405],gutterSize:4,dragInterval:1,style:{display:"flex",width:"100%"},cursor:"ew-resize",children:[eQ(),eT()]})})]})})}},46851:function(e){e.exports={layout:"Question_layout__6rvn8",layoutContent:"Question_layoutContent__JOkpM",questionContainer:"Question_questionContainer__6zO5R",codeEditor:"Question_codeEditor__aUms8",show:"Question_show__ms4Pw",layoutMobileContent:"Question_layoutMobileContent__IUgoi"}}},function(e){e.O(0,[1265,3662,2390,4806,887,9774,2888,179],function(){return e(e.s=36315)}),_N_E=e.O()}]);
//# sourceMappingURL=[questionSlug]-83da042b7cdb8d6a.js.map