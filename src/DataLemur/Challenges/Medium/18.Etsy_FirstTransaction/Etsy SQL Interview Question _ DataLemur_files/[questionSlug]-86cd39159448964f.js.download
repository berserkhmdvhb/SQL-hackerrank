(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9755],{36315:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/questions/[questionSlug]",function(){return s(42514)}])},42514:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return I},default:function(){return k},usersPageLimitAndFields:function(){return v}});var a=s(28598),i=s(82684),n=s(11598),o=s.n(n),r=s(34376),u=s(81566),l=s(35585),d=s(44806),c=s(68925),m=s.n(c),f=s(83892),g=s(50039),_=s(86105),h=s(78239),p=s(68337),y=s(41191),b=s(17603),S=s(31382);let C={id:(0,s(55402).Z)(),firstName:null,lastName:null,email:"anonymous@gmail.com",avatar:null,userName:null},E={fields:["id","slug","title","og_title","og_image","description","seo_description","solution_explanation","difficulty","proper_query","base_query","company","category","access_groups","python_function_query","python_test_cases","company_info.*"]};var x=s(46851),w=s.n(x),I=!0;let v={limit:20,fields:["id","first_name","last_name","email","user_name","avatar"]};var k=e=>{var t;let{initialQuestionData:s,isMobile:n}=e,[c]=(0,u.a)("(min-width: 890px)",{ssr:!0,fallback:!1}),{user:x,isAuthInitialized:I,isLoading:k}=(0,h.aF)(),{asPath:q}=(0,r.useRouter)(),[Q,N]=(0,i.useState)(f.BX.Watch),[{result:T,loading:M,error:O},P]=(0,i.useState)({result:null,loading:!1,error:null}),[{fetched:G,loading:j,data:D},A]=(0,i.useState)({loading:!1,fetched:!s.isGuarded,data:s}),B=D.id,F=null==x?void 0:x.id,[{fetched:L,data:z},V]=(0,i.useState)({loading:!1,fetched:!1,data:[]}),[{fetched:R,loading:K},U]=(0,i.useState)({loading:!1,fetched:!1}),[Y,X]=(0,i.useState)([]),[$,H]=(0,i.useState)([]),[J,W]=(0,i.useState)([]),[Z,ee]=(0,i.useState)(!0),[et,es]=(0,i.useState)(()=>_.t$.MostVotes),[ea,ei]=(0,i.useState)(()=>(0,y.YQ)({questionId:B,isParentIdNull:!0,limit:20,page:0})),en=(0,i.useMemo)(()=>(0,y.YQ)({questionId:B,userId:F,isParentIdNull:!0,limit:-1}),[B,F]),eo=(0,i.useMemo)(()=>(0,y.YQ)({questionId:B,isParentIdNull:!1,limit:-1}),[B]),er=(0,h.Ey)(ea),eu=(0,h.Ey)(K),el=(0,h.Ey)(Z),[ed,ec]=(0,i.useState)({loading:!1,fetched:!1,data:[]}),[em,ef]=(0,i.useState)([]),[eg,e_]=(0,i.useState)(_.OK.QuestionDescription),eh=(0,S.Wz)(e=>e.resetState),ep=!!(null==x?void 0:null===(t=x.accessGroups)||void 0===t?void 0:t.length),ey=D.title,eb=(0,p.G0)(D.category),eS=eg===_.OK.QuestionDiscussion,eC=(0,i.useMemo)(()=>D.isGuarded,[D]),eE=(0,i.useCallback)(e=>e.parentId?W(t=>[e,...t]):H(t=>[e,...t]),[]),ex=(0,i.useCallback)((e,t)=>t?W(t=>(t||[]).filter(t=>t.id!==e)):H(t=>(t||[]).filter(t=>t.id!==e)),[]),ew=(0,i.useCallback)(e=>{ec(t=>({...t,data:[...t.data,e]}))},[]);(0,i.useEffect)(()=>{ee(!0),H([]),X([]),ei(e=>({...e,sort:et===_.t$.MostVotes?"-upvotes":et===_.t$.NewestToOldest?"-created_at":"created_at",page:0}))},[et]);let eI=(0,i.useCallback)(e=>P(t=>({...t,loading:e})),[]),ev=(0,i.useCallback)(e=>P(t=>({...t,result:e})),[]),ek=(0,i.useCallback)(e=>P(t=>({...t,error:e})),[]),eq=(0,i.useCallback)(async()=>{if(x&&!eC&&!eu.current&&el.current)try{U(e=>({...e,loading:!0}));let e={...er.current,page:er.current.page+1,filter:{...er.current.filter,user_id:{_neq:x.id}}};ei(e);let t=await b.OS.getComments(e);if(0===t.length){U(e=>({...e,loading:!1})),ee(!1);return}let s=Array.from(new Set(t.map(e=>e.userId))),a=s.length>0?await b.KD.getUsersByIds(s,v):[];t.forEach(e=>{e.user=a.find(t=>t.id===e.userId)||C}),X(e=>{let s=[...e||[],...t];return(0,p._M)(s,"id")}),U(e=>({...e,loading:!1}))}catch(e){console.error(e),U(e=>({...e,loading:!1}))}},[x,eC,er,el,eu]);(0,i.useEffect)(()=>{!x||!ep&&eC||K||R||(async()=>{try{U(e=>({...e,loading:!0}));let[e,t]=await Promise.all([b.OS.getReplies(eo),b.OS.getComments(en)]);e.length&&!Y.length&&n&&eq();let s=Array.from(new Set([...e,...t].map(e=>e.userId))),a=s.length>0?await b.KD.getUsersByIds(s,v):[];t.forEach(e=>{e.user=a.find(t=>t.id===e.userId)||C}),e.forEach(e=>{e.user=a.find(t=>t.id===e.userId)||C}),W(e),H(t),U({fetched:!0,loading:!1})}catch(e){console.log(e),U({fetched:!0,loading:!1})}})()},[x,n,R,K,ep,eC,et,en,eo,Y.length,eq]),(0,i.useEffect)(()=>{if(!k&&I&&!x){A(e=>({...e,loading:!1,fetched:!0}));return}if(x){if(!x.accessGroups||!D.accessGroups||!(0,p.Jd)(x.accessGroups,D.accessGroups).length){A(e=>({...e,loading:!1,fetched:!0}));return}G||j||(async()=>{try{A(e=>({...e,loading:!0}));let e=await b.aE.getGuardedQuestionBySlug(D.slug,D.accessGroups,E);A(t=>({loading:!1,fetched:!0,data:{...e,companyInfo:t.data.companyInfo}}))}catch(e){A(e=>({...e,loading:!1,fetched:!0}))}})()}},[x,k,I,G,j,D.slug,D.accessGroups]),(0,i.useEffect)(()=>{if(I&&!eC){if(!k&&!F){V({loading:!1,fetched:!0,data:[]});return}(async()=>{V(e=>({...e,fetched:!1,loading:!0}));try{let e=await b.by.getSubmissions({fields:["id","submitted_at","status","query"],sort:"-submitted_at",filter:{user_id:{_eq:F},question_id:{_eq:B}}});V({loading:!1,fetched:!0,data:e})}catch(e){b.Yd.error(e),V({loading:!1,fetched:!0,data:[]})}})()}},[I,F,B,eC,k,x]),(0,i.useEffect)(()=>{eC||(async()=>{try{let e=await b.TE.getHints({fields:["text","order"],sort:"order",filter:{question_id:{_eq:B}}});ef(e)}catch(e){b.Yd.error(e),ef([])}})()},[B,eC]),(0,i.useEffect)(()=>{(0,p.mV)(q)},[q]),(0,i.useEffect)(()=>()=>{eh()},[eh]),(0,h.bK)(()=>{var e;if(!x)return;let t=sessionStorage.getItem(_.kP),s=t?(0,p.$2)(t):null,{category:a,difficulty:i}=D,n={event:_.tz.QuestionClicked,user_id:x.id,referrer:"https://datalemur.com/",category:a,difficulty:i,status:(null===(e=z[0])||void 0===e?void 0:e.status)||"not-started",customer_type:(0,p.jI)(x)?"Paying":"Free",landing_page:s};o().dataLayer({dataLayer:n})},x&&L);let eQ=()=>(0,a.jsx)(y.wG,{question:D,submitResult:T,submissions:z,tabIndex:eg,setTabIndex:e_,isDiscussionTabActive:eS,areSubmissionsFetched:L,submitTableError:O,isSubmitTableLoading:M,isTextQuestionLoading:Q===f.BX.Submit,hints:em,currentComments:Y,myComments:$,commentReplies:J,getMoreComments:eq,isLoadingComments:K,commentsFilter:et,setCommentsFilter:es,hasMoreComments:Z,votesState:ed,setVotesState:ec,isMobile:n,onCommentAdd:eE,onCommentDelete:ex,onVoteAdd:ew,isQuestionLoading:j}),eN=()=>(0,a.jsx)(y.up,{codeEditorClassName:w().codeEditor,currentOperation:Q,questionId:B,setTabIndex:e_,setSubmissionsState:V,setCurrentOperation:N,setIsSubmittedTableLoading:eI,setSubmittedQueryResult:ev,setSubmittedQueryError:ek,isMobile:n,isPythonQuestion:D.category===_.vu.Python,...D}),eT=()=>(0,a.jsx)(y.U5,{currentOperation:Q,setTabIndex:e_,setCurrentOperation:N,handleCommentAdd:eE,handleVoteAdd:ew,isSubmitBtnDisabled:eC,...D}),eM=()=>eb?eN():eT();return(0,a.jsx)(g.A,{className:m()(w().layout,{[w().layoutMobileContent]:n}),contentClassName:w().layoutContent,tabTitle:ey,tabDescription:D.seoDescription,...D,ogTitle:D.ogTitle||ey,isShareButtonVisible:!0,isFooterHidden:!0,children:(0,a.jsxs)(l.k,{h:"100%",p:"8px 20px 0 20px",flexDirection:"column",children:[!c&&(0,a.jsx)(y.M_,{text:"Back to questions"}),(0,a.jsx)(l.k,{marginTop:"10px",className:w().questionContainer,children:n||eS?(0,a.jsxs)(a.Fragment,{children:[eQ(),!eS&&eM()]}):(0,a.jsxs)(d.Z,{sizes:[50,50],minSize:[300,405],gutterSize:4,dragInterval:1,style:{display:"flex",width:"100%"},cursor:"ew-resize",children:[eQ(),eM()]})})]})})}},46851:function(e){e.exports={layout:"Question_layout__6rvn8",layoutContent:"Question_layoutContent__JOkpM",questionContainer:"Question_questionContainer__6zO5R",codeEditor:"Question_codeEditor__aUms8",show:"Question_show__ms4Pw",layoutMobileContent:"Question_layoutMobileContent__IUgoi"}}},function(e){e.O(0,[1265,3662,544,4806,4737,9774,2888,179],function(){return e(e.s=36315)}),_N_E=e.O()}]);
//# sourceMappingURL=[questionSlug]-86cd39159448964f.js.map